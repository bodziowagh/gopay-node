{"version":3,"sources":["Resource.js"],"names":["FormData","require","PathParameterError_1","object_1","Resource","api","compilePath","path","pathParams","replace","o","part","s","p","indexOf","defineRoute","method","required","route","data","callback","params","_params","reduce","param","i","url","missingPathParams","match","map","m","length","Promise","reject","PathParameterError","constructor","missingParams","missingKeys","send","exports"],"mappings":"AAAA;;;;;;AACA,IAAMA,WAAWC,QAAQ,WAAR,CAAjB;AACA,IAAMC,uBAAuBD,QAAQ,8BAAR,CAA7B;AACA,IAAME,WAAWF,QAAQ,iBAAR,CAAjB;;IACMG,Q;AACF,sBAAYC,GAAZ,EAAiB;AAAA;;AACb,aAAKA,GAAL,GAAWA,GAAX;AACH;;aACMC,W,wBAAYC,I,EAAMC,U,EAAY;AACjC,eAAOD,KACFE,OADE,CACM,kBADN,EAC0B,UAACC,CAAD,EAAO;AACpC,gBAAMC,OAAOD,EAAED,OAAF,CAAU,UAAV,EAAsB,UAACG,CAAD,EAAIC,CAAJ,EAAU;AACzC,uBAAOL,WAAWK,CAAX,KAAiBD,CAAxB;AACH,aAFY,CAAb;AAGA,mBAAOD,KAAKG,OAAL,CAAa,GAAb,MAAsB,CAAC,CAAvB,GAA2BH,KAAKF,OAAL,CAAa,QAAb,EAAuB,EAAvB,CAA3B,GAAwD,EAA/D;AACH,SANM,EAOFA,OAPE,CAOM,UAPN,EAOkB,UAACG,CAAD,EAAIC,CAAJ;AAAA,mBAAUL,WAAWK,CAAX,KAAiBD,CAA3B;AAAA,SAPlB,CAAP;AAQH,K;;uBACDG,W,wBAAYC,M,EAAQT,I,EAAMU,Q,EAAU;AAChC,YAAMZ,MAAM,KAAKA,GAAjB;AACA,eAAO,SAASa,KAAT,CAAeC,IAAf,EAAqBC,QAArB,EAA2D;AAAA,8CAARC,MAAQ;AAARA,sBAAQ;AAAA;;AAAA,gBAA5Bb,UAA4B,yDAAf,EAAe;;AAC9D,gBAAMc,UAAUD,OAAOE,MAAP,CAAc,UAACV,CAAD,EAAIW,KAAJ,EAAWC,CAAX,EAAiB;AAC3C,oBAAIjB,WAAWiB,CAAX,CAAJ,EAAmB;AACfZ,sBAAEL,WAAWiB,CAAX,CAAF,IAAmBJ,MAAnB;AACH;AACD,uBAAOR,CAAP;AACH,aALe,EAKb,EALa,CAAhB;AAMA,gBAAMa,MAAMtB,SAASE,WAAT,CAAqBC,IAArB,EAA2Be,OAA3B,CAAZ;AACA,gBAAMK,oBAAoB,CAACD,IAAIE,KAAJ,CAAU,aAAV,KAA4B,EAA7B,EAAiCC,GAAjC,CAAqC,UAACC,CAAD;AAAA,uBAAOA,EAAErB,OAAF,CAAU,GAAV,EAAe,EAAf,CAAP;AAAA,aAArC,CAA1B;AACA,gBAAIkB,kBAAkBI,MAAlB,GAA2B,CAA/B,EAAkC;AAC9BC,wBAAQC,MAAR,CAAe,IAAI/B,qBAAqBgC,kBAAzB,CAA4CP,kBAAkB,CAAlB,CAA5C,CAAf;AACH;AACD,gBAAI,EAAE,CAAC,CAACR,IAAF,IAAUA,KAAKgB,WAAL,KAAqBnC,QAAjC,KAA8C,QAAOmB,IAAP,yCAAOA,IAAP,OAAgB,QAAlE,EAA4E;AACxE,oBAAMiB,gBAAgBjC,SAASkC,WAAT,CAAqBlB,IAArB,EAA2BF,QAA3B,CAAtB;AACA,oBAAImB,cAAcL,MAAd,GAAuB,CAA3B,EAA8B;AAC1BC,4BAAQC,MAAR,CAAe,IAAI/B,qBAAqBgC,kBAAzB,CAA4CE,cAAc,CAAd,CAA5C,CAAf;AACH;AACJ;AACD,mBAAO/B,IAAIiC,IAAJ,CAAStB,MAAT,EAAiBU,GAAjB,EAAsBP,IAAtB,EAA4BC,QAA5B,CAAP;AACH,SAnBD;AAoBH,K;;;;;AAELmB,QAAQnC,QAAR,GAAmBA,QAAnB","file":"Resource.js","sourcesContent":["\"use strict\";\nconst FormData = require(\"form-data\");\nconst PathParameterError_1 = require(\"../errors/PathParameterError\");\nconst object_1 = require(\"../utils/object\");\nclass Resource {\n    constructor(api) {\n        this.api = api;\n    }\n    static compilePath(path, pathParams) {\n        return path\n            .replace(/\\((\\w|:|\\/)+\\)/ig, (o) => {\n            const part = o.replace(/:(\\w+)/ig, (s, p) => {\n                return pathParams[p] || s;\n            });\n            return part.indexOf(\":\") === -1 ? part.replace(/\\(|\\)/g, \"\") : \"\";\n        })\n            .replace(/:(\\w+)/ig, (s, p) => pathParams[p] || s);\n    }\n    defineRoute(method, path, required) {\n        const api = this.api;\n        return function route(data, callback, pathParams = [], ...params) {\n            const _params = params.reduce((p, param, i) => {\n                if (pathParams[i]) {\n                    p[pathParams[i]] = params;\n                }\n                return p;\n            }, {});\n            const url = Resource.compilePath(path, _params);\n            const missingPathParams = (url.match(/:([a-z]+)/ig) || []).map((m) => m.replace(\":\", \"\"));\n            if (missingPathParams.length > 0) {\n                Promise.reject(new PathParameterError_1.PathParameterError(missingPathParams[0]));\n            }\n            if (!(!!data && data.constructor === FormData) && typeof data === \"object\") {\n                const missingParams = object_1.missingKeys(data, required);\n                if (missingParams.length > 0) {\n                    Promise.reject(new PathParameterError_1.PathParameterError(missingParams[0]));\n                }\n            }\n            return api.send(method, url, data, callback);\n        };\n    }\n}\nexports.Resource = Resource;\n"]}